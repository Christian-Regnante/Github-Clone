<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitHub Clone - Sign In</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/svg+xml" data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill="black" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/></svg>>
</head>
<body class="login-page">
    <div class="login-container">
        <header class="login-header">
            <div class="github-logo">
                <svg height="48" viewBox="0 0 16 16" version="1.1" width="48" aria-hidden="true">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
                </svg>
            </div>
            <h1>Sign in to GitHub Clone</h1>
        </header>

        <main class="login-main">
            <div class="login-box">
                <div class="login-content">
                    <h2>Welcome to GitHub Clone</h2>
                    <p class="login-description">
                        Access your GitHub repositories, create project showcases, and manage your development portfolio.
                    </p>
                    
                    <div class="auth-section">
                        <button id="github-login-btn" class="github-login-button" onclick="loginWithGitHub()">
                            <svg class="github-icon" height="20" viewBox="0 0 16 16" version="1.1" width="20" aria-hidden="true">
                                <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
                            </svg>
                            Sign in with GitHub
                        </button>

                        <div class="loading-indicator" id="loading" style="display: none;">
                            <div class="spinner"></div>
                            <span>Authenticating...</span>
                        </div>
                    </div>

                    <div class="features-list">
                        <h3>What you can do:</h3>
                        <ul>
                            <li>üìä View your GitHub profile and statistics</li>
                            <li>üìÅ Browse and search your repositories</li>
                            <li>üé® Generate project showcase cards</li>
                            <li>üìã Export portfolio HTML snippets</li>
                            <li>üåü GitHub-style dashboard experience</li>
                        </ul>
                    </div>
                </div>

                <div class="login-footer">
                    <p class="terms">
                        By signing in, you agree to our 
                        <a href="#" onclick="showModal('terms')">Terms of Service</a> and 
                        <a href="#" onclick="showModal('privacy')">Privacy Policy</a>
                    </p>
                </div>
            </div>
        </main>

        <footer class="page-footer">
            <p>&copy; 2024 GitHub Clone. Built with ‚ù§Ô∏è for developers.</p>
            <div class="footer-links">
                <a href="https://github.com" target="_blank">GitHub</a>
                <a href="#" onclick="showModal('about')">About</a>
                <a href="#" onclick="showModal('contact')">Contact</a>
            </div>
        </footer>
    </div>

    <!-- Modals -->
    <div id="modal-overlay" class="modal-overlay" onclick="hideModal()" style="display: none;">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h3 id="modal-title">Modal Title</h3>
                <button class="modal-close" onclick="hideModal()">&times;</button>
            </div>
            <div class="modal-body" id="modal-body">
                Modal content goes here
            </div>
        </div>
    </div>

    <script>
        // Dynamic backend URL - works for both development and Docker deployment
        const BACKEND_URL = window.location.port === '8080' 
            ? 'http://localhost:3000'  // Development: separate frontend/backend servers
            : window.location.origin;   // Docker: same origin for both frontend and backend

        // Check if user is already authenticated
        async function checkAuthStatus() {
            try {
                const response = await fetch(`${BACKEND_URL}/api/auth/status`, {
                    credentials: 'include'
                });
                const data = await response.json();
                
                if (data.authenticated) {
                    // User is already logged in, redirect to dashboard
                    window.location.href = 'dashboard.html';
                }
            } catch (error) {
                console.log('Not authenticated or server not available');
            }
        }

        // GitHub OAuth login
        function loginWithGitHub() {
            const button = document.getElementById('github-login-btn');
            const loading = document.getElementById('loading');
            
            // Show loading state
            button.style.display = 'none';
            loading.style.display = 'flex';
            
            // Redirect to GitHub OAuth
            window.location.href = `${BACKEND_URL}/auth/github`;
        }

        // Modal functions
        function showModal(type) {
            const modal = document.getElementById('modal-overlay');
            const title = document.getElementById('modal-title');
            const body = document.getElementById('modal-body');
            
            let content = '';
            switch(type) {
                case 'terms':
                    title.textContent = 'Terms of Service';
                    content = `
                        <p>This is a demo application for educational purposes.</p>
                        <p>By using this application, you agree to:</p>
                        <ul>
                            <li>Use the service responsibly</li>
                            <li>Not attempt to break or abuse the system</li>
                            <li>Understand this is a portfolio project</li>
                        </ul>
                    `;
                    break;
                case 'privacy':
                    title.textContent = 'Privacy Policy';
                    content = `
                        <p>This application:</p>
                        <ul>
                            <li>Only accesses public GitHub data you authorize</li>
                            <li>Does not store your personal information permanently</li>
                            <li>Uses session-based authentication</li>
                            <li>Does not share your data with third parties</li>
                        </ul>
                    `;
                    break;
                case 'about':
                    title.textContent = 'About GitHub Clone';
                    content = `
                        <p>GitHub Clone is a portfolio project demonstrating:</p>
                        <ul>
                            <li>GitHub OAuth integration</li>
                            <li>REST API consumption</li>
                            <li>Modern web development practices</li>
                            <li>GitHub-style UI/UX design</li>
                        </ul>
                        <p>Built with vanilla HTML, CSS, JavaScript and Node.js</p>
                    `;
                    break;
                case 'contact':
                    title.textContent = 'Contact';
                    content = `
                        <p>This is a demo project. For questions or feedback:</p>
                        <p>Check out the source code or create an issue on the project repository.</p>
                    `;
                    break;
            }
            
            body.innerHTML = content;
            modal.style.display = 'flex';
        }

        function hideModal() {
            document.getElementById('modal-overlay').style.display = 'none';
        }

        // Handle escape key for modal
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                hideModal();
            }
        });

        // Check auth status on page load
        document.addEventListener('DOMContentLoaded', checkAuthStatus);
    </script>
</body>
</html>